@page "/"

<PageTitle>
    Time Tracker
</PageTitle>

@if (WeekEntryModel is not null)
{
    <MudDatePicker @ref="_picker"
                   @bind-Date="startDate"
                   @bind-Date:after="@OnStartDateChangedAsync"
                   Label="Start Date"
                   Mask="@(new DateMask("MM/dd/yyyy"))"
                   Editable="true"
                   PickerVariant="PickerVariant.Dialog"
                   DateFormat="MM/dd/yyyy">
        <PickerActions>
            <MudButton Class="mr-auto align-self-start"
                       OnClick="@(() => { if(_picker is not null) { _picker.GoToDate(DateTime.Today, true); _picker.Close(); } })">
                Today
            </MudButton>
            <MudButton OnClick="@(() => _picker?.Close(false))">
                Cancel
            </MudButton>
            <MudButton Color="Color.Primary"
                       OnClick="@(() => _picker?.Close())">
                Ok
            </MudButton>
        </PickerActions>
    </MudDatePicker>
    <WeekEntry WeekEntryModel="WeekEntryModel" />
}

<MudPaper Class="border-solid border-4 mud-border-error my-4 pa-2"
          Elevation="0">
    <MudText Typo="@Typo.h5"
             Color="@Color.Error">
        Danger Zone
    </MudText>
    <MudFileUpload T="@IBrowserFile"
                   FilesChanged="HandleFile">
        <ButtonTemplate>
            <TtButton HtmlTag="label"
                      Color="@Color.Primary"
                      StartIcon="@Icons.Material.Filled.CloudUpload"
                      for="@context">
                Choose a file to import
            </TtButton>
        </ButtonTemplate>
    </MudFileUpload>
    <TtButton Disabled="@(browserFile is null)"
              Class="mt-2 mb-4"
              @onclick=ImportData>
        Import
    </TtButton>
    <MudStack Row="@true"
              Spacing="2">
        <TtButton @onclick=ExportData>
            Export
        </TtButton>
        <TtButton Color="@Color.Error"
                  @onclick=ClearAllDataAsync>
            Clear All Data
        </TtButton>
    </MudStack>
</MudPaper>
